import { ImageResponse } from 'next/og';
import { NextRequest } from 'next/server';

type Params = {
  id: string;
};

export async function GET(
  request: NextRequest,
  { params }: { params: { store: string } }
) {
  const {
    nextUrl: { search },
  } = request;
  const urlSearchParams = new URLSearchParams(search);
  const searchItems = Object.fromEntries(urlSearchParams.entries());

  const searchParams = request.nextUrl.searchParams;

  const image = searchParams.get('image');
  const storeName = searchParams.get('shop');
  if (storeName === null || image === null) {
    return new ImageResponse(
      (
        <div
          style={{
            height: '100%',
            width: '100%',
            display: 'flex',
            textAlign: 'center',
            alignItems: 'center',
            justifyContent: 'center',
            flexDirection: 'column',
            flexWrap: 'nowrap',
            backgroundColor: '#111518',
          }}
        >
          <div
            style={{
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
            }}
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              x="0px"
              y="0px"
              viewBox="0 0 512 496.9"
              style={{
                width: '200px',
                height: '194.101px',
              }}
            >
              <g>
                <g>
                  <path
                    fill="#3B5DAA"
                    d="M469.1,361.5H42.9C19.2,361.5,0,342.3,0,318.6V42.9C0,19.2,19.2,0,42.9,0h426.2C492.8,0,512,19.2,512,42.9
			v275.7C512,342.3,492.8,361.5,469.1,361.5z"
                  />
                  <path
                    fill="#214696"
                    d="M42.9,361.5h426.2c23.7,0,42.9-19.2,42.9-42.9V180.7H0v137.9C0,342.3,19.2,361.5,42.9,361.5z"
                  />
                  <g>
                    <g>
                      <path
                        fill="#FFFFFF"
                        d="M354.8,116.4v21.4H220.3l25.8-25.8c6.9-6.9,16-10.7,25.8-10.7h21.9V76.8c0-1.8,1.4-3.2,3.2-3.2
					c0.9,0,1.7,0.4,2.3,0.9c0.6,0.6,0.9,1.4,0.9,2.3v24.7h15V66c0-1.8,1.4-3.2,3.2-3.2c0.9,0,1.7,0.4,2.3,0.9
					c0.6,0.6,0.9,1.4,0.9,2.3v35.4h18.2C348.1,101.4,354.8,108.2,354.8,116.4z"
                      />
                    </g>
                    <g>
                      <path
                        fill="#FFFFFF"
                        d="M76.2,180.4c-3.3,1.2-6.3,3.2-8.7,5.7v-39l30,11.3v14L76.2,180.4z"
                      />
                      <path
                        fill="#FFFFFF"
                        d="M76.2,223.9l21.3,8v10.9l-30,13.6v-38.3C69.9,220.8,72.9,222.7,76.2,223.9z"
                      />
                      <path fill="none" d="M67.5,147.1L67.5,147.1" />
                    </g>
                    <g>
                      <path
                        fill="#FFFFFF"
                        d="M437.7,184H275.5c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2h159.6c-2.7-5.8-6.4-11.1-11.1-15.9
					c-11-11.2-25.7-17.4-41.4-17.4H197.5c-4.4,0-8.7,0.8-12.8,2.3L104,176.9l-6.4,2.4l-19.1,7.1l0,0l0,0
					c-6.5,2.4-10.9,8.7-10.9,15.7c0,7,4.4,13.3,10.9,15.7l0,0l0,0l19.1,7.1l6.4,2.4l80.7,30.3c4.1,1.5,8.4,2.3,12.8,2.3h184.6
					c15.3,0,29.9-5.9,40.9-16.5c11-10.7,17.3-24.9,17.6-40.2C440.7,196.7,439.7,190.1,437.7,184z M232.6,184h-42.9
					c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2h42.9c1.8,0,3.2,1.4,3.2,3.2C235.8,182.5,234.4,184,232.6,184z M254.1,212.9
					c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C257.3,211.5,255.8,212.9,254.1,212.9z M297,212.9
					c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C300.2,211.5,298.7,212.9,297,212.9z M339.8,212.9
					c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C343.1,211.5,341.6,212.9,339.8,212.9z M382.7,212.9
					c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C385.9,211.5,384.5,212.9,382.7,212.9z"
                      />
                    </g>
                  </g>
                  <g>
                    <path
                      fill="#D6D6D6"
                      d="M437.7,184H275.5c-1.8,0-3.2-1.4-3.2-3.2h-36.4c0,1.8-1.4,3.2-3.2,3.2h-42.9c-1.8,0-3.2-1.4-3.2-3.2H93.7
				l-15.2,5.7l0,0l0,0c-6.5,2.4-10.9,8.7-10.9,15.7c0,7,4.4,13.3,10.9,15.7l0,0l0,0l19.1,7.1l6.4,2.4l80.7,30.3
				c4.1,1.5,8.4,2.3,12.8,2.3h184.6c15.3,0,29.9-5.9,40.9-16.5c11-10.7,17.3-24.9,17.6-40.2C440.7,196.7,439.7,190.1,437.7,184z
				 M254.1,212.9c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C257.3,211.5,255.9,212.9,254.1,212.9z
				 M297,212.9c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C300.2,211.5,298.7,212.9,297,212.9z
				 M339.8,212.9c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C343.1,211.5,341.6,212.9,339.8,212.9z
				 M382.7,212.9c-1.8,0-3.2-1.4-3.2-3.2c0-1.8,1.4-3.2,3.2-3.2c1.8,0,3.2,1.4,3.2,3.2C385.9,211.5,384.5,212.9,382.7,212.9z"
                    />
                  </g>
                  <path
                    fill="#D6D6D6"
                    d="M76.2,223.9c-3.3-1.2-6.3-3.2-8.7-5.7v38.3l30-13.6v-10.9L76.2,223.9z"
                  />
                  <path
                    fill="#D6D6D6"
                    d="M67.5,147.2v39c2.4-2.5,5.4-4.5,8.7-5.7l21.3-8v-14L67.5,147.2z"
                  />
                  <path
                    fill="#D6D6D6"
                    d="M339.8,101.4h-68c-9.7,0-18.9,3.8-25.8,10.7l-25.8,25.8h134.6v-21.4C354.8,108.2,348.1,101.4,339.8,101.4z"
                  />
                </g>
                <g>
                  <path
                    fill="#FFFFFF"
                    d="M221.8,452.7h-0.2c0,0,0.1,0,0.1,0S221.8,452.7,221.8,452.7z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M264.1,435.4H239v61.5h9.6v-26h15.5c5.3,0,9.6-4.3,9.6-9.6V445C273.7,439.7,269.4,435.4,264.1,435.4z
			 M264.1,459.2c0,1.2-1,2.1-2.1,2.1h-13.4V445H262c1.2,0,2.1,1,2.1,2.1V459.2z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M349,452.7h-15.6v0h-9.6v44.2h9.6v-17.3H349c3.5,0,6.6-1.9,8.2-4.8v0c0,0,0-0.1,0.1-0.1c0,0,0,0,0,0
			c0-0.1,0.1-0.2,0.1-0.3c0-0.1,0.1-0.2,0.1-0.3c0,0,0-0.1,0.1-0.1c0,0,0-0.1,0.1-0.1c0-0.1,0-0.1,0.1-0.2c0-0.1,0.1-0.1,0.1-0.2
			c0-0.1,0-0.1,0.1-0.2c0.1-0.2,0.1-0.3,0.2-0.5c0,0,0-0.1,0-0.1c0,0,0-0.1,0-0.1c0-0.1,0.1-0.2,0.1-0.3c0-0.1,0.1-0.3,0.1-0.4
			c0,0,0-0.1,0-0.1c0-0.1,0-0.1,0-0.2c0-0.1,0-0.1,0-0.2c0,0,0-0.1,0-0.1c0,0,0,0,0-0.1c0,0,0,0,0,0c0,0,0-0.1,0-0.1
			c0-0.2,0-0.3,0-0.5c0,0,0,0,0-0.1c0,0,0-0.1,0-0.1c0-0.1,0-0.1,0-0.2c0-0.1,0-0.1,0-0.2v-7.8C358.4,457,354.2,452.8,349,452.7z
			 M348.9,467.9c0,1.2-1,2.1-2.1,2.1h-13.4v-7.8h13.4c1.2,0,2.1,1,2.1,2.1V467.9z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M349,479.6C348.9,479.6,348.9,479.6,349,479.6c-0.1,0-0.2,0-0.2,0H349z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M357.4,474.4c0,0.1-0.1,0.2-0.1,0.3C357.3,474.6,357.3,474.5,357.4,474.4z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M346.8,470C346.8,470,346.8,470,346.8,470l-13.4,0v0H346.8z"
                  />
                  <polygon
                    fill="#FFFFFF"
                    points="400.1,452.7 400.1,462.3 387.6,462.3 387.6,496.9 378,496.9 378,462.3 366.1,462.3 366.1,452.7 		"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M188.9,452.7v34.6c0,5.3-4.3,9.6-9.6,9.6h-15.5c-5.3,0-9.6-4.3-9.6-9.6v-34.6h9.6v32.5c0,1.2,1,2.1,2.1,2.1
			h11.2c1.2,0,2.1-1,2.1-2.1v-32.5H188.9z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M306.5,452.7H291c-5.3,0-9.6,4.3-9.6,9.6v25.1c0,5.3,4.3,9.6,9.6,9.6h15.5c5.3,0,9.6-4.3,9.6-9.6v-25.1
			C316.1,457,311.8,452.7,306.5,452.7z M306.5,485.2c0,1.2-1,2.1-2.1,2.1h-11.2c-1.2,0-2.1-1-2.1-2.1v-20.8c0-1.2,1-2.1,2.1-2.1
			h11.2c1.2,0,2.1,1,2.1,2.1V485.2z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M136.9,452.7v-5.6c0-1.2-1-2.1-2.1-2.1h-11.2c-1.2,0-2.1,1-2.1,2.1v10.4c0,1,0.6,1.8,1.6,2.1l13.9,3.7
			l2.5,0.7c4.2,1.1,7.1,4.9,7.1,9.3v14.1c0,5.3-4.3,9.6-9.6,9.6h-15.5c-5.3,0-9.6-4.3-9.6-9.6v-7.8h9.6v5.6c0,1.2,1,2.1,2.1,2.1
			h11.2c1.2,0,2.1-1,2.1-2.1v-10.4c0-1-0.6-1.8-1.6-2.1l-13.9-3.7l-2.5-0.7c-4.2-1.1-7.1-4.9-7.1-9.3V445c0-5.3,4.3-9.6,9.6-9.6
			h15.5c5.3,0,9.6,4.3,9.6,9.6v7.8H136.9z"
                  />
                  <path
                    fill="#FFFFFF"
                    d="M231.3,462.3c0-2.6-1.1-5-2.8-6.8c-1.7-1.7-4.1-2.8-6.8-2.8h-25.1v44.2h25.1c2.6,0,5-1.1,6.8-2.8
			c1.7-1.7,2.8-4.1,2.8-6.8v-7.8c0-1.7-0.5-3.4-1.3-4.8c0.8-1.4,1.3-3,1.3-4.8V462.3z M221.7,485.2c0,1.2-1,2.1-2.1,2.1h-13.4v-7.8
			h13.4c1.2,0,2.1,1,2.1,2.1V485.2z M221.7,467.9c0,1.2-1,2.1-2.1,2.1h-13.4v-7.8h13.4c1.2,0,2.1,1,2.1,2.1V467.9z"
                  />
                </g>
              </g>
            </svg>
          </div>
          <div
            style={{
              display: 'flex',
              fontSize: 24,
              fontStyle: 'normal',
              color: 'white',
              marginTop: 15,
              // lineHeight: 1.8,
              whiteSpace: 'pre-wrap',
            }}
          >
            <b>Creator Platform</b>
          </div>
        </div>
      ),
      {
        width: 1200,
        height: 630,
      }
    );
  }
  return new ImageResponse(
    (
      <div
        style={{
          height: '100%',
          width: '100%',
          display: 'flex',
          textAlign: 'center',
          alignItems: 'center',
          justifyContent: 'center',
          flexDirection: 'column',
          flexWrap: 'nowrap',
          backgroundColor: '#111518',
        }}
      >
        <div
          style={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
          }}
        >
          <img
            width="300"
            height="300"
            alt={storeName!}
            src={image!}
            style={{
              borderRadius: 150,
            }}
          />
        </div>
        <div
          style={{
            display: 'flex',
            fontSize: 60,
            fontStyle: 'normal',
            color: 'white',
            marginTop: 30,
            lineHeight: 1.8,
            whiteSpace: 'pre-wrap',
          }}
        >
          <b>{storeName!}</b>
        </div>
        <div
          style={{
            display: 'flex',
            fontSize: 20,
            fontStyle: 'normal',
            color: 'white',
            marginTop: 15,
            lineHeight: 0.5,
            whiteSpace: 'pre-wrap',
          }}
        >
          <b>by SubPort Creator Platform</b>
        </div>
      </div>
    ),
    {
      width: 1200,
      height: 630,
    }
  );
}
